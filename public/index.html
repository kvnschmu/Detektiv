<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juristischer Sachverhaltstext Generator</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 40px auto; padding: 0 20px; line-height: 1.6; }
        h1 { text-align: center; }
        form { background: #f9f9f9; padding: 20px; border-radius: 8px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        textarea { width: 100%; padding: 10px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; resize: vertical; min-height: 100px; }
        button { display: block; width: 100%; padding: 15px; border: none; background-color: #007bff; color: white; font-size: 16px; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        #resultContainer { display: none; margin-top: 30px; }
        #resultPre { background: #f4f4f4; padding: 20px; border-radius: 8px; white-space: pre-wrap; }
        .disclaimer { margin-top: 30px; font-size: 0.9em; color: #888; }
        #loading { text-align: center; font-style: italic; color: #555; display: none; }
    </style>
</head>
<body>

    <h1>Sachverhaltstext erstellen</h1>
    <form id="factForm">
        <label for="tatort">1. Tatzeit und -ort:</label>
        <textarea id="tatort" name="tatort" placeholder="Gib das genaue Datum, die Uhrzeit und den Ort an."></textarea>

        <label for="tathandlung">2. Tathandlung:</label>
        <textarea id="tathandlung" name="tathandlung" placeholder="Beschreibe den genauen Tathergang und wie die Gegenstände verstaut wurden."></textarea>

        <label for="zeugen">3. Zeugen und Festnahme:</label>
        <textarea id="zeugen" name="zeugen" placeholder="Wer hat die Tat beobachtet? Beschreibe die Festnahme."></textarea>

        <label for="beweismittel">4. Beweismittel:</label>
        <textarea id="beweismittel" name="beweismittel" placeholder="Welche Beweismittel liegen vor? (z.B. Videoaufzeichnungen, sichergestellte Gegenstände)"></textarea>

        <button type="submit">Sachverhaltstext erstellen</button>
    </form>

    <div id="loading">... wird erstellt ...</div>
    
    <div id="resultContainer">
        <h2>Generierter Sachverhaltstext</h2>
        <pre id="resultPre"></pre>
        <p class="disclaimer">Hinweis: Dieser Text wurde von einer KI erstellt und ist kein juristischer Rat.</p>
        <button onclick="window.location.reload();">Neuen Sachverhalt erstellen</button>
    </div>
    
    <script>
        const form = document.getElementById('factForm');
        const loading = document.getElementById('loading');
        const resultContainer = document.getElementById('resultContainer');
        const resultPre = document.getElementById('resultPre');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            loading.style.display = 'block';
            form.style.display = 'none';

            const formData = new FormData(form);
            const queryParams = new URLSearchParams(formData).toString();
            
            try {
                const response = await fetch('/.netlify/functions/generate-text?' + queryParams);
                
                const data = await response.json();
                
                loading.style.display = 'none';

                if (data.error) {
                    resultPre.textContent = 'Fehler: ' + data.error;
                } else {
                    resultPre.textContent = data.text;
                }
                
                resultContainer.style.display = 'block';

            } catch (error) {
                loading.style.display = 'none';
                resultContainer.style.display = 'block';
                resultPre.textContent = 'Ein unerwarteter Fehler ist aufgetreten: ' + error.message;
            }
        });
    </script>

</body>
</html>
